// ets_tracing: off
import { pipe } from "../../Function/index.js";
import * as Q from "../../Queue/index.js";
import * as T from "../_internal/effect.js";
import * as M from "../_internal/managed.js";
import { intoManaged_ } from "./intoManaged.js";
/**
 * Converts the stream to a managed queue of chunks. After the managed queue is used,
 * the queue will never again produce values and should be discarded.
 */

export function toQueue_(self, capacity) {
  return M.map_(M.tap_(M.bind_(M.do, "queue", () => T.toManagedRelease_(Q.makeBounded(capacity), Q.shutdown)), ({
    queue
  }) => M.fork(intoManaged_(self, queue))), ({
    queue
  }) => queue);
}
/**
 * Converts the stream to a managed queue of chunks. After the managed queue is used,
 * the queue will never again produce values and should be discarded.
 */

export function toQueue(capacity) {
  return self => toQueue_(self, capacity);
}
//# sourceMappingURL=toQueue.js.map